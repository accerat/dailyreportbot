import { SlashCommandBuilder } from 'discord.js'; import { runReminderPass } from '../jobs/remindersRuntime.js'; export const data=new SlashCommandBuilder().setName('admin-reminders-now').setDescription('[Admin] Run the hourly reminder pass right now').addIntegerOption(o=>o.setName('project_id').setDescription('Optional project ID')); export async function execute(i){ if(!isAdmin(i)) return; await i.deferReply({flags:64}); const pid=i.options.getInteger('project_id')??null; const sent=await runReminderPass(pid); await i.editReply(`Reminder pass complete. DMs attempted for ${sent} project(s).`);} function isAdmin(i){ const allowed=(process.env.ADMIN_USER_IDS||'').split(',').filter(Boolean); if(allowed.includes(i.user.id)) return true; if(i.memberPermissions?.has('Administrator')) return true; i.reply({content:'Admins only.', flags:64}); return false; }
